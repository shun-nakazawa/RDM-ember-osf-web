{{! using unsafeTitle here to avoid double encoding because the title helper does its own }}
{{title (t 'iqbrims.page_title' nodeTitle=this.model.taskInstance.value.unsafeTitle)}}
<div class='container' local-class='IQBRIMS'>
    <div local-class='IQBRIMS__editor'>
        {{#if this.modeDeposit}}
            <div class='form-group row'>
                <label class='col-sm-2' for='paper_title'>{{t 'iqbrims.paper_title'}}</label>
                <div class='col-sm-10'>
                    {{this.paperTitle}}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='contributors'>{{t 'iqbrims.contributors'}}</label>
                <div class='col-sm-10'>
                    <div>
                        {{this.owner.fullName}}
                    </div>
                    <select class='form-control' onchange={{action this.contributorTypeChanged value='target.value'}}>
                        <option selected={{if (eq this.contributorType 'first-author') 'selected'}} value='first-author'>
                            {{t 'iqbrims.contributor_types.first_author'}}
                        </option>
                        <option selected={{if (eq this.contributorType 'second-author') 'selected'}} value='second-author'>
                            {{t 'iqbrims.contributor_types.second_author'}}
                        </option>
                    </select>
                    {{#each this.otherContributors as |item|}}
                        <div>
                            {{item.fullName}}
                        </div>
                    {{/each}}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='labo'>{{t 'iqbrims.labo'}}</label>
                <div class='col-sm-10'>
                    <select class='form-control' onchange={{action this.laboChanged value='target.value'}}>
                        {{#each this.laboList as |item|}}
                            <option selected={{if (eq this.laboId item.id) 'selected'}} value='{{item.id}}'>
                                {{item.text}}
                            </option>
                        {{/each}}
                    </select>
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='email'>{{t 'iqbrims.email'}}</label>
                <div class='col-sm-10'>
                    {{#each this.owner.emails as |email|}}
                        <div>
                            {{email.emailAddress}}
                        </div>
                    {{/each}}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='accepted_date'>{{t 'iqbrims.accepted_date'}}</label>
                <div class='col-sm-10'>
                    {{input
                        name='accepted_date'
                        placeholder=(t 'iqbrims.placeholders.accepted_date')
                        class='form-control'
                        value=this.acceptedDate
                        type='text'
                    }}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='journal_name'>{{t 'iqbrims.journal_name'}}</label>
                <div class='col-sm-10'>
                    {{input
                        name='journal_name'
                        placeholder=(t 'iqbrims.placeholders.journal_name')
                        class='form-control'
                        value=this.journalName
                        type='text'
                    }}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='doi'>{{t 'iqbrims.doi'}}</label>
                <div class='col-sm-10'>
                    {{input
                        name='doi'
                        placeholder=(t 'iqbrims.placeholders.doi')
                        class='form-control'
                        value=this.doi
                        type='text'
                    }}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='publish_date'>{{t 'iqbrims.publish_date'}}</label>
                <div class='col-sm-10'>
                    {{input
                        name='publish_date'
                        placeholder=(t 'iqbrims.placeholders.publish_date')
                        class='form-control'
                        value=this.publishDate
                        type='text'
                    }}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='volume'>{{t 'iqbrims.volume'}}</label>
                <div class='col-sm-10'>
                    {{input
                        name='volume'
                        placeholder=(t 'iqbrims.placeholders.volume')
                        class='form-control'
                        value=this.volume
                        type='text'
                    }}
                </div>
            </div>
            <div class='form-group row'>
                <label class='col-sm-2' for='page_number'>{{t 'iqbrims.page_number'}}</label>
                <div class='col-sm-10'>
                    {{input
                        name='page_number'
                        placeholder=(t 'iqbrims.placeholders.page_number')
                        class='form-control'
                        value=this.pageNumber
                        type='text'
                    }}
                </div>
            </div>
            <div class='form-group row'>
                <label>{{t 'iqbrims.submit_manuscripts'}}</label>
                <FileBrowser
                    @dzUploadButtonClass='dz-manuscript-upload-button'
                    @user={{this.user}}
                    @items={{this.manuscriptFiles.files}}
                    @filter={{this.manuscriptFiles.filter}}
                    @sort={{this.manuscriptFiles.sort}}
                    @canEdit={{this.manuscriptFiles.canEdit}}
                    @newProject={{this.manuscriptFiles.newProject}}
                    @openFile={{action this.manuscriptFiles.openFile}}
                    @updateFilter={{perform this.manuscriptFiles.updateFilter}}
                    @dropZoneId='manuscript-dropzone'
                    @deleteFiles={{perform this.manuscriptFiles.deleteFiles}}
                    @moveFile={{perform this.manuscriptFiles.moveFile}}
                    @renameFile={{perform this.manuscriptFiles.renameFile}}
                    @addFile={{perform this.manuscriptFiles.addFile}}
                    @buildUrl={{action this.buildManuscriptFileUrl}}
                />
            </div>
            <div class='form-group row'>
                <label>{{t 'iqbrims.submit_data'}}</label>
                <FileBrowser
                    @dzUploadButtonClass='dz-data-upload-button'
                    @user={{this.user}}
                    @items={{this.dataFiles.files}}
                    @filter={{this.dataFiles.filter}}
                    @sort={{this.dataFiles.sort}}
                    @canEdit={{this.dataFiles.canEdit}}
                    @newProject={{this.dataFiles.newProject}}
                    @openFile={{action this.dataFiles.openFile}}
                    @updateFilter={{perform this.dataFiles.updateFilter}}
                    @dropZoneId='data-dropzone'
                    @deleteFiles={{perform this.dataFiles.deleteFiles}}
                    @moveFile={{perform this.dataFiles.moveFile}}
                    @renameFile={{perform this.dataFiles.renameFile}}
                    @addFile={{perform this.dataFiles.addFile}}
                    @buildUrl={{action this.buildDataFileUrl}}
                />
            </div>
            <div class='form-group row'>
                <label>{{t 'iqbrims.submit_checklist'}}</label>
                <FileBrowser
                    @dzUploadButtonClass='dz-checklist-upload-button'
                    @user={{this.user}}
                    @items={{this.checklistFiles.files}}
                    @filter={{this.checklistFiles.filter}}
                    @sort={{this.checklistFiles.sort}}
                    @canEdit={{this.checklistFiles.canEdit}}
                    @newProject={{this.checklistFiles.newProject}}
                    @openFile={{action this.checklistFiles.openFile}}
                    @updateFilter={{perform this.checklistFiles.updateFilter}}
                    @dropZoneId='checklist-dropzone'
                    @deleteFiles={{perform this.checklistFiles.deleteFiles}}
                    @moveFile={{perform this.checklistFiles.moveFile}}
                    @renameFile={{perform this.checklistFiles.renameFile}}
                    @addFile={{perform this.checklistFiles.addFile}}
                    @buildUrl={{action this.buildChecklistFileUrl}}
                />
            </div>
            <div class='text-right'>
                <OsfButton @type='default'
                           @onClick={{action this.discardInput}}>
                    {{t 'iqbrims.discard_button'}}
                </OsfButton>
                <OsfButton @type='success'
                           @onClick={{action this.saveInput}}>
                    {{t 'iqbrims.save_button'}}
                </OsfButton>
            </div>
        {{else if this.modeCheck}}
        {{else}}
            <div class='form-group'>
                <OsfButton @type='primary'
                           @onClick={{action this.startDeposit}}>
                    {{t 'iqbrims.deposit_button'}}
                </OsfButton>
                <small class='form-text text-muted'>
                    {{t 'iqbrims.deposit_help'}}
                </small>
            </div>
            <div class='form-group'>
                <OsfButton @type='primary'
                           @onClick={{action this.startCheck}}>
                    {{t 'iqbrims.check_button'}}
                </OsfButton>
                <small class='form-text text-muted'>
                    {{t 'iqbrims.check_help'}}
                </small>
            </div>
        {{/if}}
    </div>
</div>
